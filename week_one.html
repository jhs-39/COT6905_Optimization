

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Week 1: Matrix Review &#8212; COT6905 Advanced Optimization</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'week_one';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Week 2: Spaces" href="week_two.html" />
    <link rel="prev" title="Syllabus" href="syllabus.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="syllabus.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="COT6905 Advanced Optimization - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="COT6905 Advanced Optimization - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="syllabus.html">
                    Syllabus
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Week 1: Matrix Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="week_two.html">Week 2: Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="week_three.html">Week 3: Independence, Spaces, Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="week_four.html">Week 4: Orthogonal Basis and Projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="week_five.html">Week 5: Determinants</a></li>
<li class="toctree-l1"><a class="reference internal" href="week_six.html">Week 6:</a></li>
<li class="toctree-l1"><a class="reference internal" href="week_seven.html">Week 7:</a></li>
<li class="toctree-l1"><a class="reference internal" href="info_theory.html">Information Theory: Introduction to Shannon Entropy</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jhs-39/COT6905_Optimization/master?urlpath=tree/docs/week_one.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jhs-39/COT6905_Optimization" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jhs-39/COT6905_Optimization/issues/new?title=Issue%20on%20page%20%2Fweek_one.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/week_one.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="_sources/week_one.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Week 1: Matrix Review</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-1-the-geometry-of-linear-equations">Lecture 1: The Geometry of Linear Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts">Key Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#row-picture">Row Picture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-picture">Column Picture</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-2-elimination-with-matrices">Lecture 2: Elimination with matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Key Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-elimination">Gaussian Elimination</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pivots">Pivots:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elimination-matrices">Elimination Matrices:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#permutation-matrices">Permutation Matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#composing-an-elimination-matrix">Composing an Elimination Matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#breakdowns">Breakdowns:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-3-multiplication-and-inverse-matrices">Lecture 3: Multiplication and inverse matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#five-ways-to-look-at-matrix-multiplication">Five Ways to Look at Matrix Multiplication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dot-product-of-rows-in-a-and-columns-in-b">Dot Product of Rows in A and Columns in B:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-way-linear-combinations-of-columns">Column Way (Linear Combinations of Columns):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#row-way-linear-combinations-of-rows">Row Way (Linear Combinations of Rows):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outer-product-way-sum-of-rank-1-matrices">Outer Product Way (Sum of Rank-1 Matrices):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-block-multiplication">Bonus: Block Multiplication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-inverses">Matrix Inverses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#singular-matrices-no-inverse">Singular Matrices (No Inverse)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-inverse-via-systems-of-equations">Finding the Inverse via Systems of Equations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-4-factorization-into-a-lu">Lecture 4: Factorization into A = LU</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-of-matrix-products">Inverse of Matrix Products</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lu-factorization-decomposing-matrices">LU Factorization: Decomposing Matrices</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="week-1-matrix-review">
<h1>Week 1: Matrix Review<a class="headerlink" href="#week-1-matrix-review" title="Permalink to this heading">#</a></h1>
<section id="lecture-1-the-geometry-of-linear-equations">
<h2>Lecture 1: The Geometry of Linear Equations<a class="headerlink" href="#lecture-1-the-geometry-of-linear-equations" title="Permalink to this heading">#</a></h2>
<iframe width="560" height="315"
    src="https://www.youtube.com/embed/J7DzL2_Na80"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen>
</iframe>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>This lecture introduces linear algebra through the lens of solving systems of equations. We can view matrices two ways, either through the “row picture” (geometric intersection of lines/planes defined by each row-equation) and the “column picture” (linear combinations of vectors corresponding to each column).</p>
</section>
<section id="key-concepts">
<h2>Key Concepts<a class="headerlink" href="#key-concepts" title="Permalink to this heading">#</a></h2>
<section id="row-picture">
<h3>Row Picture<a class="headerlink" href="#row-picture" title="Permalink to this heading">#</a></h3>
<p>Each row from the matrix form represents a line (in 2D) or plane (in 3D). Solutions occur at the intersections of these structures.
Below is an interactive visualization of the row picture for a 2x2 system of equations (ax + by = c and dx + ey = f). Launch a live code session (Rocket Icon-&gt;Live Code) and change the coefficients to observe how the lines and their intersection point (solution) change!</p>
<blockquote>
<div><p>Question for understanding: will you be able to get a solution [X, Y] for <strong>any point</strong> in the plane, if the given rows are parallel lines? Hint: parallel lines don’t intersect!</p>
</div></blockquote>
<div class="cell tag_thebe docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import numpy as np
import matplotlib.pyplot as plt
from IPython.display import display, Markdown

# Try changing these values!
row1 = [1.0, .5, 2.0]  # [x1, y1, c1]
row2 = [3.0, 2.0, 1.0]  # [x2, y2, c2]

x = np.linspace(-5, 5, 200)

def plot_row_picture(row1, row2):
    a1, b1, c1 = row1
    a2, b2, c2 = row2
   
    fig, ax = plt.subplots(figsize=(6,6))
   
    # Line 1
    if b1 != 0:
        y1 = (c1 - a1*x)/b1
        ax.plot(x, y1, &#39;b-&#39;, label=f&#39;{a1:.1f}x + {b1:.1f}y = {c1:.1f}&#39;)
    else:
        ax.axvline(c1/a1 if a1 != 0 else 0, color=&#39;b&#39;,
                   label=f&#39;x = {(c1/a1):.1f}&#39; if a1 != 0 else &#39;No line&#39;)
   
    # Line 2
    if b2 != 0:
        y2 = (c2 - a2*x)/b2
        ax.plot(x, y2, &#39;r-&#39;, label=f&#39;{a2:.1f}x + {b2:.1f}y = {c2:.1f}&#39;)
    else:
        ax.axvline(c2/a2 if a2 != 0 else 0, color=&#39;r&#39;,
                   label=f&#39;x = {(c2/a2):.1f}&#39; if a2 != 0 else &#39;No line&#39;)
   
    # Intersection
    A = np.array([[a1, b1], [a2, b2]])
    b_vec = np.array([c1, c2])
    det = np.linalg.det(A)
   
    if det != 0:
        sol = np.linalg.solve(A, b_vec)
        ax.plot(sol[0], sol[1], &#39;ko&#39;, markersize=8, label=f&#39;Solution: ({sol[0]:.2f},{sol[1]:.2f})&#39;)
        sol_text = f&quot;Solution: x = {sol[0]:.2f}, y = {sol[1]:.2f}&quot;
    else:
        sol_text = &quot;No unique solution (parallel or coincident lines)&quot;
   
    # Plot formatting
    ax.set_xlim(-5, 5)
    ax.set_ylim(-5, 5)
    ax.axhline(0, color=&#39;k&#39;, alpha=0.3)
    ax.axvline(0, color=&#39;k&#39;, alpha=0.3)
    ax.grid(True)
    ax.set_xlabel(&#39;x&#39;)
    ax.set_ylabel(&#39;y&#39;)
    ax.set_title(&#39;Row Picture: Intersection of Lines&#39;)
    ax.legend()
    plt.show()

# Call the function with the defined rows
plot_row_picture(row1, row2)
</pre></div>
</div>
</div>
</div>
</section>
<section id="column-picture">
<h3>Column Picture<a class="headerlink" href="#column-picture" title="Permalink to this heading">#</a></h3>
<p>As a completely equivalent alternative, we can split the matrix into its column vectors. Our geometric intuition here is rather different. In this form, the solutions for x and y are the proper linear combination of column vectors that are equivalent to the desired solution vector. Again, each column vector represents a vector in the space; a solution to the problem is the right combination of the column vectors (e.g., you find a combination of x=.5 * vector 1 and y=2.75 * vector 2 are equivalent to the desired vector)</p>
<blockquote>
<div><p>Question for understanding: if your column vectors are parallel or lie on the same line, can you compose a vector that is <strong>off</strong> that parallel line in terms of the given column vectors? Try it in the code below! How is this equivalent to our earlier question in row picture form?</p>
</div></blockquote>
<div class="cell tag_thebe docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import numpy as np
import matplotlib.pyplot as plt
from IPython.display import display, Markdown

# Try changing these values!
col1 = [1.0, -.5]  # First column of A: [a1, a2]
col2 = [.5, 2.0]  # Second column of A: [b1, b2]
b_vec = [2.0, 1.0]  # Target vector: [c1, c2]

def plot_column_picture(col1, col2, b_vec):
    # Extract coefficients
    a1, a2 = col1
    b1, b2 = col2
    c1, c2 = b_vec
    
    # Define matrix A
    A = np.array([[a1, b1], [a2, b2]])
    
    # Solve for x, y (coefficients for column vectors)
    det = np.linalg.det(A)
    if det != 0:
        sol = np.linalg.solve(A, b_vec)
        x, y = sol
        sol_text = f&quot;Solution: x = {x:.2f}, y = {y:.2f}&quot;
    else:
        sol_text = &quot;No unique solution (columns are linearly dependent)&quot;
    
    # Plot setup
    fig, ax = plt.subplots(figsize=(6, 6))
    
    # Plot column vectors (reference, saturated)
    ax.arrow(0, 0, a1, a2, color=&#39;b&#39;, width=0.1, head_width=0.3, head_length=0.4,
             label=f&#39;Column 1: [{a1:.1f}, {a2:.1f}]&#39;, alpha=1.0)
    ax.arrow(0, 0, b1, b2, color=&#39;r&#39;, width=0.1, head_width=0.3, head_length=0.4,
             label=f&#39;Column 2: [{b1:.1f}, {b2:.1f}]&#39;, alpha=1.0)
    
    # Plot target vector b
    ax.arrow(0, 0, c1, c2, color=&#39;g&#39;, width=0.1, head_width=0.3, head_length=0.4,
             label=f&#39;Target: [{c1:.1f}, {c2:.1f}]&#39;)
    
    # Plot linear combination if solution exists (more transparent)
    if det != 0:
        # Plot x * col1 from origin, tip at (x*a1, x*a2)
        ax.arrow(0, 0, x*a1, x*a2, color=&#39;b&#39;, width=0.1, head_width=0.3, head_length=0.4,
                 label=f&#39;{x:.2f} * Column 1&#39;, alpha=0.5)
        # Plot y * col2 from (x*a1, x*a2) to (c1, c2), tip at (c1, c2)
        ax.arrow(x*a1, x*a2, c1 - x*a1, c2 - x*a2, color=&#39;r&#39;, width=0.1, head_width=0.3, head_length=0.4,
                 label=f&#39;{y:.2f} * Column 2&#39;, alpha=0.5)
        # Solution point
        ax.plot(c1, c2, &#39;ko&#39;, markersize=8, label=f&#39;Solution point: ({c1:.2f}, {c2:.2f})&#39;)
    
    # Plot formatting
    max_val = max(np.abs([a1, a2, b1, b2, c1, c2])) * 1.5
    ax.set_xlim(-max_val, max_val)
    ax.set_ylim(-max_val, max_val)
    ax.axhline(0, color=&#39;k&#39;, alpha=0.3)
    ax.axvline(0, color=&#39;k&#39;, alpha=0.3)
    ax.grid(True)
    ax.set_xlabel(&#39;x&#39;)
    ax.set_ylabel(&#39;y&#39;)
    ax.set_title(&#39;Column Picture: Linear Combination of Columns&#39;)
    ax.legend()
    plt.show()

# Call the function with the defined columns and target vector
plot_column_picture(col1, col2, b_vec)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="lecture-2-elimination-with-matrices">
<h2>Lecture 2: Elimination with matrices<a class="headerlink" href="#lecture-2-elimination-with-matrices" title="Permalink to this heading">#</a></h2>
<iframe width="560" height="315"
    src="https://www.youtube.com/embed/QVKj3LADCnA"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen>
</iframe>
</section>
<section id="id1">
<h2>Key Concepts<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<section id="gaussian-elimination">
<h3>Gaussian Elimination<a class="headerlink" href="#gaussian-elimination" title="Permalink to this heading">#</a></h3>
<p>A systematic process to solve ( Ax = b ) by performing <strong>row operations</strong>:</p>
<ol class="arabic simple">
<li><p>Swap two rows.</p></li>
<li><p>Multiply a row by a nonzero scalar.</p></li>
<li><p>Add or subtract a multiple of one row to another.</p></li>
</ol>
<p>The goal is to convert ( A ) to an <strong>upper triangular matrix</strong> ( U ), then solve ( Ux = c ) by back-substitution.</p>
<p>For example, consider the system</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
x + 2y + z = 9 \\
2x - y + 3z = 13 \\
-x + y + 2z = 3
\end{cases}
\end{split}\]</div>
<p>We can write it in <strong>augmented matrix form</strong>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[
\begin{array}{ccc|c}
1 &amp; 2 &amp; 1 &amp; 9 \\
2 &amp; -1 &amp; 3 &amp; 13 \\
-1 &amp; 1 &amp; 2 &amp; 3
\end{array}
\right]
\end{split}\]</div>
<p>Perform <strong>row operations</strong> to eliminate variables below the diagonal:</p>
<div class="math notranslate nohighlight">
\[
R_2 \leftarrow R_2 - 2R_1
\]</div>
<div class="math notranslate nohighlight">
\[
R_3 \leftarrow R_3 + R_1
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[
\begin{array}{ccc|c}
1 &amp; 2 &amp; 1 &amp; 9 \\
0 &amp; -5 &amp; 1 &amp; -5 \\
0 &amp; 3 &amp; 3 &amp; 12
\end{array}
\right]
\end{split}\]</div>
<p>Next, eliminate the element below the pivot in column 2:</p>
<div class="math notranslate nohighlight">
\[
R_3 \leftarrow R_3 + \frac{3}{5} R_2
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[
\begin{array}{ccc|c}
1 &amp; 2 &amp; 1 &amp; 9 \\
0 &amp; -5 &amp; 1 &amp; -5 \\
0 &amp; 0 &amp; \frac{18}{5} &amp; 9
\end{array}
\right]
\end{split}\]</div>
<p>Finally, perform <strong>back-substitution</strong> to solve for ( x, y, z ):</p>
<p>Back-substitution:</p>
<div class="math notranslate nohighlight">
\[
z = \frac{9}{18/5} = \frac{9 \cdot 5}{18} = \frac{45}{18} = \frac{5}{2}
\]</div>
<div class="math notranslate nohighlight">
\[
y = \frac{-5 - 1 \cdot z}{-5} = \frac{-5 - 5/2}{-5} = \frac{-10/2 - 5/2}{-5} = \frac{-15/2}{-5} = \frac{15/2}{5} = \frac{15}{10} = \frac{3}{2}
\]</div>
<div class="math notranslate nohighlight">
\[
x = 9 - 2y - z = 9 - 2 \cdot \frac{3}{2} - \frac{5}{2} = 9 - 3 - 2.5 = 3.5 = \frac{7}{2}
\]</div>
</section>
<section id="pivots">
<h3>Pivots:<a class="headerlink" href="#pivots" title="Permalink to this heading">#</a></h3>
<p>The <strong>pivot</strong> is the first non-zero entry in a row after elimination. Pivots indicate the variables we solve for in each step. For example, consider:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = 
\begin{bmatrix}
2 &amp; 1 &amp; -1 \\
-3 &amp; -1 &amp; 2 \\
-1 &amp; 1 &amp; 2
\end{bmatrix}
\end{split}\]</div>
<p>After the first elimination step to zero out the first column below the pivot:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
\color{blue}{2} &amp; 1 &amp; -1 \\
0 &amp; -0.5 &amp; 0.5 \\
0 &amp; 1.5 &amp; 1.5
\end{bmatrix}
\end{split}\]</div>
<p>Here, the <strong>pivot in the first row</strong> is highlighted in <strong>blue</strong>.</p>
</section>
<section id="elimination-matrices">
<h3>Elimination Matrices:<a class="headerlink" href="#elimination-matrices" title="Permalink to this heading">#</a></h3>
<p>Eliminate the first column below the pivot using</p>
<div class="math notranslate nohighlight">
\[
R_2 \leftarrow R_2 + \frac{3}{2} R_1
\]</div>
<p>corresponds to</p>
<div class="math notranslate nohighlight">
\[\begin{split}
E_1 = 
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
3/2 &amp; 1 &amp; 0 \\
1/2 &amp; 0 &amp; 1
\end{bmatrix}, 
\quad E_1 A = A^{(1)}
\end{split}\]</div>
<ol class="arabic simple" start="2">
<li><p>Eliminate the second column below the second pivot using</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
R_3 \leftarrow R_3 - 3 R_2
\]</div>
<p>corresponds to</p>
<div class="math notranslate nohighlight">
\[\begin{split}
E_2 = 
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; -3 &amp; 1
\end{bmatrix}, 
\quad E_2 A^{(1)} = U
\end{split}\]</div>
<p>Thus, the overall elimination is</p>
<div class="math notranslate nohighlight">
\[
E_2 E_1 A = U
\]</div>
</section>
<section id="permutation-matrices">
<h3>Permutation Matrices<a class="headerlink" href="#permutation-matrices" title="Permalink to this heading">#</a></h3>
<p>Sometimes the next pivot is <strong>zero</strong>, and we need to move a row to continue elimination. This is done via a <strong>permutation matrix</strong> ( P ), which acts on the left:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
PA =
\begin{bmatrix}
0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
0 &amp; 2 &amp; 1 \\
3 &amp; 1 &amp; -1 \\
1 &amp; -1 &amp; 2
\end{bmatrix}
=
\begin{bmatrix}
3 &amp; 1 &amp; -1 \\
0 &amp; 2 &amp; 1 \\
1 &amp; -1 &amp; 2
\end{bmatrix}
\end{split}\]</div>
<blockquote>
<div><p>Note: Row permutations are <strong>left-multiplications</strong>, column permutations are <strong>right-multiplications</strong>.</p>
</div></blockquote>
</section>
<section id="composing-an-elimination-matrix">
<h3>Composing an Elimination Matrix<a class="headerlink" href="#composing-an-elimination-matrix" title="Permalink to this heading">#</a></h3>
<p>We can combine multiple elimination steps into a <strong>single matrix</strong> (E) using the associative property of matrix multiplication:</p>
<div class="math notranslate nohighlight">
\[
E_1 (E_2 A) = (E_1 E_2) A
\]</div>
<p>Thus, we can define a single elimination matrix:</p>
<div class="math notranslate nohighlight">
\[
E = E_1 E_2
\]</div>
<p>Using the example above, applying (E_1) and then (E_2) to (A) is equivalent to applying (E) to (A):</p>
<div class="math notranslate nohighlight">
\[
E A = (E_1 E_2) A = E_1 (E_2 A)
\]</div>
<p>This allows us to <strong>combine all elimination steps</strong> into one matrix, simplifying both notation and computation.</p>
</section>
<section id="breakdowns">
<h3>Breakdowns:<a class="headerlink" href="#breakdowns" title="Permalink to this heading">#</a></h3>
<p>Elimination fails if a pivot is zero and no row swap can fix it, indicating the matrix is <strong>singular</strong> (non-invertible) or the system has <strong>no or infinitely many solutions</strong>.</p>
<p>For example, consider the system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
x + y + z = 3 \\
2x + 2y + 2z = 6 \\
x + y + z = 4
\end{cases}
\end{split}\]</div>
<p>Augmented matrix form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[
\begin{array}{ccc|c}
1 &amp; 1 &amp; 1 &amp; 3 \\
2 &amp; 2 &amp; 2 &amp; 6 \\
1 &amp; 1 &amp; 1 &amp; 4
\end{array}
\right]
\end{split}\]</div>
<p>Attempting Gaussian elimination:</p>
<ul class="simple">
<li><p>Eliminate the first column below the pivot:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
R_2 \leftarrow R_2 - 2R_1, \quad
R_3 \leftarrow R_3 - R_1
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[
\begin{array}{ccc|c}
1 &amp; 1 &amp; 1 &amp; 3 \\
0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{array}
\right]
\end{split}\]</div>
<p>Notice the last row corresponds to (0x + 0y + 0z = 1), which is impossible.</p>
<p><strong>Conclusion:</strong> This system has <strong>no solution</strong>, and the elimination “breaks down” due to a zero pivot that cannot be swapped to fix the inconsistency.</p>
</section>
</section>
<section id="lecture-3-multiplication-and-inverse-matrices">
<h2>Lecture 3: Multiplication and inverse matrices<a class="headerlink" href="#lecture-3-multiplication-and-inverse-matrices" title="Permalink to this heading">#</a></h2>
<iframe width="560" height="315"
    src="https://www.youtube.com/embed/FX4C-JpTFgY"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen>
</iframe>
<section id="five-ways-to-look-at-matrix-multiplication">
<h3>Five Ways to Look at Matrix Multiplication<a class="headerlink" href="#five-ways-to-look-at-matrix-multiplication" title="Permalink to this heading">#</a></h3>
<p>Matrix multiplication is a fundamental operation in linear algebra. There are a number of equivalent ways to think about this operation, and for developing intuition and solving problems in the field, you should know them all.</p>
<p>First, review some basics:<br />
Consider the matrix product <span class="math notranslate nohighlight">\(AB = C\)</span><br />
Let’s say matrix A has m rows and n columns; <span class="math notranslate nohighlight">\(m \times n\)</span><br />
Matrix B has n rows and p columns <span class="math notranslate nohighlight">\( n \times p \)</span><br />
Their product C is a matrix with m rows and p colums, <span class="math notranslate nohighlight">\(m \times p \)</span>. The number of columns in A must match the number of rows in B.</p>
</section>
<section id="dot-product-of-rows-in-a-and-columns-in-b">
<h3>Dot Product of Rows in A and Columns in B:<a class="headerlink" href="#dot-product-of-rows-in-a-and-columns-in-b" title="Permalink to this heading">#</a></h3>
<p>Each element <span class="math notranslate nohighlight">\(c_{ij}\)</span> in C is the dot product of the i-th row of A and the j-th column of B:</p>
<div class="math notranslate nohighlight">
\[c_{ij} = \sum_{k=1}^{m} a_{ik} b_{kj}\]</div>
<p>This is the form most often taught to students. Look at the highlights below:</p>
<p><span class="math notranslate nohighlight">\(\textbf{Matrix A (3x2):}\)</span>
<span class="math notranslate nohighlight">\(
A = \begin{bmatrix}
{\color{red}{1}} &amp; {\color{red}{2}} \\
3 &amp; 4 \\
5 &amp; 6
\end{bmatrix}
\)</span></p>
<p>First row highlighted.</p>
<p><span class="math notranslate nohighlight">\(\textbf{Matrix B (2x2):}\)</span>
<span class="math notranslate nohighlight">\(
B = \begin{bmatrix}
{\color{orange}{7}} &amp; 8 \\
{\color{orange}{9}} &amp; 10
\end{bmatrix}
\)</span></p>
<p>First column highlighted.</p>
<p>Computing <span class="math notranslate nohighlight">\(c_{11}\)</span> (first element of C):</p>
<p><span class="math notranslate nohighlight">\(
c_{11} = {\color{red}{1}} \cdot {\color{orange}{7}} + {\color{red}{2}} \cdot {\color{orange}{9}} = 7 + 18 = 25
\)</span></p>
<p>Resulting Matrix C (3x2, with element <span class="math notranslate nohighlight">\(C_{11}\)</span> computed):</p>
<p><span class="math notranslate nohighlight">\(
C = \begin{bmatrix}
25 &amp; \_ \\
\_ &amp; \_ \\
\_ &amp; \_
\end{bmatrix}
\)</span></p>
<p>Fill in the rest of the matrix by hand for practice! Can you compute the full first row or column following this example?</p>
</section>
<section id="column-way-linear-combinations-of-columns">
<h3>Column Way (Linear Combinations of Columns):<a class="headerlink" href="#column-way-linear-combinations-of-columns" title="Permalink to this heading">#</a></h3>
<p>View A as a collection of column vectors <span class="math notranslate nohighlight">\(\mathbf{A}_1, \mathbf{A}_2, \dots, \mathbf{A}_p\)</span>. Then, the columns of C are given by linear combinations of the column vectors of A with coefficients given by B:</p>
<div class="math notranslate nohighlight">
\[\mathbf{c}_j = \sum_{k=1}^{n} \mathbf{b}_{jk} A_j \]</div>
<p>Each column of C is a linear combination of the columns of A, with coefficients from the corresponding column of B. Let’s carry on the example from above and show the equivalence:</p>
<p><span class="math notranslate nohighlight">\(\textbf{Matrix A (3x2):}\)</span>
<span class="math notranslate nohighlight">\(
A = \begin{bmatrix}
\color{red}{1} &amp; \color{orange}{2} \\
\color{red}{3} &amp; \color{orange}{4} \\
\color{red}{5} &amp; \color{orange}{6}
\end{bmatrix}
\)</span></p>
<p><span class="math notranslate nohighlight">\(\textbf{Matrix B (2x2):}\)</span>
<span class="math notranslate nohighlight">\(
B = \begin{bmatrix}
\color{green}{7} &amp; 8 \\
\color{purple}{9} &amp; 10
\end{bmatrix}
\)</span></p>
<p>Computing <span class="math notranslate nohighlight">\(c_1\)</span> (first column of C):</p>
<p><span class="math notranslate nohighlight">\(
\mathbf{c}_1 = {\color{green}{7}} \cdot \begin{bmatrix} \color{red}{1} \\ \color{red}{3} \\ \color{red}{5} \end{bmatrix} + {\color{purple}{9}} \cdot \begin{bmatrix} \color{orange}{2} \\ \color{orange}{4} \\ \color{orange}{6} \end{bmatrix} = \begin{bmatrix} 7 \\ 21 \\ 35 \end{bmatrix} + \begin{bmatrix} 18 \\ 36 \\ 54 \end{bmatrix} = \begin{bmatrix} 25 \\ 57 \\ 89 \end{bmatrix}
\)</span>
<span class="math notranslate nohighlight">\(\textbf{Resulting column of Matrix C:}\)</span>
<span class="math notranslate nohighlight">\(
C = \begin{bmatrix}
25 &amp; \_\_ \\
57 &amp; \_\_ \\
89 &amp; \_\_
\end{bmatrix}
\)</span></p>
<p>Can you complete the second column by hand, following this example?</p>
</section>
<section id="row-way-linear-combinations-of-rows">
<h3>Row Way (Linear Combinations of Rows):<a class="headerlink" href="#row-way-linear-combinations-of-rows" title="Permalink to this heading">#</a></h3>
<p>View <span class="math notranslate nohighlight">\(B\)</span> as a collection of row vectors <span class="math notranslate nohighlight">\(\mathbf{B}_1, \mathbf{B}_2, \dots, \mathbf{B}_m \)</span>. Then, the rows of <span class="math notranslate nohighlight">\(C\)</span> are given by linear combinations of the row vectors of <span class="math notranslate nohighlight">\( B \)</span>, with coefficients from the corresponding row of <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{c}_i = \sum_{k=1}^{n} a_{ik} \mathbf{B}_k \]</div>
<p>Each row of <span class="math notranslate nohighlight">\(C\)</span> is a linear combination of the rows of <span class="math notranslate nohighlight">\(B\)</span>, with coefficients from the corresponding row of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\textbf{Matrix A (3x2):}\)</span>
<span class="math notranslate nohighlight">\(A = \begin{bmatrix} {\color{red}{1}} &amp; {\color{red}{2}} \\ 3 &amp; 4 \\ 5 &amp; 6 \end{bmatrix}\)</span></p>
<p><span class="math notranslate nohighlight">\(\textbf{Matrix B (2x2):}\)</span></p>
<p><span class="math notranslate nohighlight">\(B = \begin{bmatrix} {\color{green}{7}} &amp; {\color{green}{8}} \\ {\color{purple}{9}} &amp; {\color{purple}{10}} \end{bmatrix}\)</span></p>
<p>Computing <span class="math notranslate nohighlight">\(\mathbf{c}_1\)</span> (first row of C):</p>
<p><span class="math notranslate nohighlight">\(\mathbf{c}_1 = {\color{red}{1}} \cdot \begin{bmatrix} {\color{green}{7}} &amp; {\color{green}{8}} \end{bmatrix} + {\color{red}{2}} \cdot \begin{bmatrix} {\color{purple}{9}} &amp; {\color{purple}{10}} \end{bmatrix} = \begin{bmatrix} 7 &amp; 8 \end{bmatrix} + \begin{bmatrix} 18 &amp; 20 \end{bmatrix} = \begin{bmatrix} 25 &amp; 28 \end{bmatrix}\)</span></p>
<p>Resulting row of Matrix C:
<span class="math notranslate nohighlight">\(C = \begin{bmatrix} 25 &amp; 28 \\ \_ &amp; \_ \\ \_ &amp; \_ \end{bmatrix}\)</span></p>
<p>Can you complete the other two rows by hand?</p>
</section>
<section id="outer-product-way-sum-of-rank-1-matrices">
<h3>Outer Product Way (Sum of Rank-1 Matrices):<a class="headerlink" href="#outer-product-way-sum-of-rank-1-matrices" title="Permalink to this heading">#</a></h3>
<p>Matrix multiplication <span class="math notranslate nohighlight">\( C = A \cdot B \)</span> can be expressed as a sum of outer products, where each outer product is formed by multiplying a column of <span class="math notranslate nohighlight">\( A \)</span> by a row of <span class="math notranslate nohighlight">\( B \)</span>. Here, <span class="math notranslate nohighlight">\(B_k^T\)</span> are the row vectors of B (e.g., the column vectors of the transpose matrix <span class="math notranslate nohighlight">\(B^T\)</span>). The resulting matrix <span class="math notranslate nohighlight">\( C \)</span> is:</p>
<p><span class="math notranslate nohighlight">\( C = \sum_{k=1}^{n} \mathbf{A}_k \cdot \mathbf{B}_k^T \)</span></p>
<p>where <span class="math notranslate nohighlight">\( \mathbf{A}_k \)</span> is the k-th column of <span class="math notranslate nohighlight">\( A \)</span>, and <span class="math notranslate nohighlight">\( \mathbf{B}_k^T \)</span> is the k-th row of <span class="math notranslate nohighlight">\( B \)</span>.</p>
<p><span class="math notranslate nohighlight">\(\textbf{Matrix A (3x2):}\)</span></p>
<p><span class="math notranslate nohighlight">\( A = \begin{bmatrix} \color{red}{1} &amp; \color{orange}{2} \\ \color{red}{3} &amp; \color{orange}{4} \\ \color{red}{5} &amp; \color{orange}{6} \end{bmatrix} \)</span></p>
<p><span class="math notranslate nohighlight">\(\textbf{Matrix B (2x2):}\)</span></p>
<p><span class="math notranslate nohighlight">\( B = \begin{bmatrix} \color{green}{7} &amp; \color{green}{8} \\ \color{purple}{9} &amp; \color{purple}{10} \end{bmatrix} \)</span></p>
<p>Computing the first outer product (k=1):</p>
<p><span class="math notranslate nohighlight">\( \mathbf{A}_1 \cdot \mathbf{B}_1^T = \begin{bmatrix} \color{red}{1} \\ \color{red}{3} \\ \color{red}{5} \end{bmatrix} \cdot \begin{bmatrix} \color{green}{7} &amp; \color{green}{8} \end{bmatrix} = \begin{bmatrix} 1 \cdot 7 &amp; 1 \cdot 8 \\ 3 \cdot 7 &amp; 3 \cdot 8 \\ 5 \cdot 7 &amp; 5 \cdot 8 \end{bmatrix} = \begin{bmatrix} 7 &amp; 8 \\ 21 &amp; 24 \\ 35 &amp; 40 \end{bmatrix} \)</span></p>
<p>Computing the second outer product (k=2):</p>
<p><span class="math notranslate nohighlight">\( \mathbf{A}_2 \cdot \mathbf{B}_2^T = \begin{bmatrix} \color{orange}{2} \\ \color{orange}{4} \\ \color{orange}{6} \end{bmatrix} \cdot \begin{bmatrix} \color{purple}{9} &amp; \color{purple}{10} \end{bmatrix} = \begin{bmatrix} 2 \cdot 9 &amp; 2 \cdot 10 \\ 4 \cdot 9 &amp; 4 \cdot 10 \\ 6 \cdot 9 &amp; 6 \cdot 10 \end{bmatrix} = \begin{bmatrix} 18 &amp; 20 \\ 36 &amp; 40 \\ 54 &amp; 60 \end{bmatrix} \)</span></p>
<p>Adding the outer products:</p>
<p><span class="math notranslate nohighlight">\( C = \begin{bmatrix} 7 &amp; 8 \\ 21 &amp; 24 \\ 35 &amp; 40 \end{bmatrix} + \begin{bmatrix} 18 &amp; 20 \\ 36 &amp; 40 \\ 54 &amp; 60 \end{bmatrix} = \begin{bmatrix} 7 + 18 &amp; 8 + 20 \\ 21 + 36 &amp; 24 + 40 \\ 35 + 54 &amp; 40 + 60 \end{bmatrix} = \begin{bmatrix} 25 &amp; 28 \\ 57 &amp; 64 \\ 89 &amp; 100 \end{bmatrix} \)</span></p>
<p>The complete matrix <span class="math notranslate nohighlight">\( C \)</span> is:</p>
<p><span class="math notranslate nohighlight">\( C = \begin{bmatrix} 25 &amp; 28 \\ 57 &amp; 64 \\ 89 &amp; 100 \end{bmatrix} \)</span></p>
</section>
<section id="bonus-block-multiplication">
<h3>Bonus: Block Multiplication<a class="headerlink" href="#bonus-block-multiplication" title="Permalink to this heading">#</a></h3>
<p>For large matrices, block multiplication can be efficient (e.g., in parallel computing like CUDA). This becomes extraordinarily important in deep neural nets, where large matrices are multiplied on GPU and these operations need to be broken down into efficient sub-computations. Suppose A and B are both square matrices divided into four quadrants (blocks) each:</p>
<p><span class="math notranslate nohighlight">\(A = \begin{pmatrix} A_{11} &amp; A_{12} \\ A_{21} &amp; A_{22} \end{pmatrix}, \quad B = \begin{pmatrix} B_{11} &amp; B_{12} \\ B_{21} &amp; B_{22} \end{pmatrix}\)</span></p>
<p>Then:</p>
<p><span class="math notranslate nohighlight">\(AB = \begin{pmatrix} A_{11}B_{11} + A_{12}B_{21} &amp; A_{11}B_{12} + A_{12}B_{22} \\ A_{21}B_{11} + A_{22}B_{21} &amp; A_{21}B_{12} + A_{22}B_{22} \end{pmatrix}\)</span></p>
</section>
<section id="matrix-inverses">
<h3>Matrix Inverses<a class="headerlink" href="#matrix-inverses" title="Permalink to this heading">#</a></h3>
<p>Not all matrices have inverses. For a square matrix <span class="math notranslate nohighlight">\(A\)</span> of size <span class="math notranslate nohighlight">\(n \times n \)</span>, the inverse <span class="math notranslate nohighlight">\( A^{-1} \)</span> (if it exists) satisfies:</p>
<p><span class="math notranslate nohighlight">\(A^{-1} A = I_n = A A^{-1}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(I_n\)</span> is the <span class="math notranslate nohighlight">\(n \times n\)</span> identity matrix</p>
<p>Example:</p>
<p><span class="math notranslate nohighlight">\(
A = \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix} 
\)</span></p>
<p><span class="math notranslate nohighlight">\(
A^{-1} = \begin{bmatrix} -2 &amp; 1 \\ \frac{3}{2} &amp; -\frac{1}{2} \end{bmatrix}
\)</span></p>
<p><span class="math notranslate nohighlight">\(
A A^{-1} = \begin{bmatrix} -2+3 &amp; 1-1 \\ -6+6 &amp; 3-2 \end{bmatrix} = \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}
\)</span></p>
</section>
<section id="singular-matrices-no-inverse">
<h3>Singular Matrices (No Inverse)<a class="headerlink" href="#singular-matrices-no-inverse" title="Permalink to this heading">#</a></h3>
<p>Let’s examine Singular Matrices (those without inverses) from three equivalent perspectives (there are others we will get to with spaces later!)
A matrix <span class="math notranslate nohighlight">\(A\)</span> is singular (non-invertible) if:
-&gt; The determinant <span class="math notranslate nohighlight">\(\det(A) = 0\)</span>
-&gt; The columns (or rows) of <span class="math notranslate nohighlight">\(A\)</span> are linearly dependent (e.g., one column or row is a scalar multiple of another)
-&gt; There exists a nonzero vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> such that <span class="math notranslate nohighlight">\(A \mathbf{x} = \mathbf{0}\)</span></p>
<p>All of these reduce to the same idea/concept – let’s work an example to see why</p>
<p>Example:
Let’s start with noticing something by multipling Ax=0 by A inverse on both sides:</p>
<p><span class="math notranslate nohighlight">\(
A^{-1} A x = A^{-1} 0
\)</span></p>
<p>This gives us the result:<br />
<span class="math notranslate nohighlight">\(
x = 0
\)</span>
<br />
Which can only be true if the only vector x that makes Ax=0 is the 0 vector. Let’s plug in some numbers and demonstrate.</p>
<p>Let’s pick a matrix with columns that are scalar multiples of each other so we can guarantee the matrix is singular:</p>
<p><span class="math notranslate nohighlight">\(
A = \begin{bmatrix} 1 &amp; 2 \\ 2 &amp; 4 \end{bmatrix}
\)</span></p>
<p>See the second column is just the first column times 2? What are the downstream effects of this choice? Let’s find a vector x such that Ax = 0</p>
<p><span class="math notranslate nohighlight">\(
Ax = 0
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\begin{bmatrix} 1 &amp; 2 \\ 2 &amp; 4 \end{bmatrix} * \begin{bmatrix} a \\ b \end{bmatrix} = 
\begin{bmatrix} 0 \\ 0 \end{bmatrix} \\
\)</span>
<br />
<span class="math notranslate nohighlight">\(
a + 2b = 0
\)</span>
<br />
<span class="math notranslate nohighlight">\(
2a + 4b = 0
\)</span></p>
<p>Notice that the equations reduce to the same <span class="math notranslate nohighlight">\(a +2b = 0\)</span> since they lie on the same line. Any multiple of <span class="math notranslate nohighlight">\(x = \begin{bmatrix} -2 \\ 1 \end{bmatrix} \)</span> will cause Ax=0</p>
<p>Plugging in the previous result, we see the resulting nonsense:<br />
<span class="math notranslate nohighlight">\(
\begin{bmatrix} -2 \\ 1 \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \end{bmatrix}
\)</span></p>
<p>Which can’t be true. This is why if you can find any nonzero vector <span class="math notranslate nohighlight">\(x\)</span> for <span class="math notranslate nohighlight">\(Ax=0\)</span>, the matrix <span class="math notranslate nohighlight">\(A\)</span> is singular.</p>
</section>
<section id="finding-the-inverse-via-systems-of-equations">
<h3>Finding the Inverse via Systems of Equations<a class="headerlink" href="#finding-the-inverse-via-systems-of-equations" title="Permalink to this heading">#</a></h3>
<p><strong>Gauss-Jordan Elimination</strong></p>
<p>To compute the inverse of a square matrix <span class="math notranslate nohighlight">\(A\)</span>, augment <span class="math notranslate nohighlight">\(A\)</span> with the <span class="math notranslate nohighlight">\(n \times n\)</span> identity matrix <span class="math notranslate nohighlight">\(I_n\)</span> to form <span class="math notranslate nohighlight">\(A \mid I_n\)</span>. Perform row operations to reduce the left side to <span class="math notranslate nohighlight">\(I_n\)</span>; the right side will then be <span class="math notranslate nohighlight">\(A^{-1}\)</span>:</p>
<p><span class="math notranslate nohighlight">\(A \mid I_n \xrightarrow{\text{row operations}} I_n \mid A^{-1}\)</span></p>
<p>If a zero appears on the diagonal and cannot be fixed by row swaps, the matrix is singular and has no inverse.</p>
<p>Example:</p>
<p>Consider the 2x2 matrix:</p>
<p><span class="math notranslate nohighlight">\( A = \begin{pmatrix} 1 &amp; 2 \\ 3 &amp; 5 \end{pmatrix} \)</span></p>
<p>Augment with the 2x2 identity matrix:</p>
<p><span class="math notranslate nohighlight">\( A \mid I = \begin{pmatrix} 1 &amp; 2 &amp; \mid &amp; 1 &amp; 0 \\ 3 &amp; 5 &amp; \mid &amp; 0 &amp; 1 \end{pmatrix} \)</span></p>
<p>Perform row operations to transform the left side into the identity matrix:</p>
<p>Eliminate below the first pivot (1):</p>
<p><span class="math notranslate nohighlight">\( R_2 \leftarrow R_2 - 3R_1 \)</span></p>
<p><span class="math notranslate nohighlight">\( \begin{pmatrix} 1 &amp; 2 &amp; \mid &amp; 1 &amp; 0 \\ 3 &amp; 5 &amp; \mid &amp; 0 &amp; 1 \end{pmatrix} \rightarrow \begin{pmatrix} 1 &amp; 2 &amp; \mid &amp; 1 &amp; 0 \\ 0 &amp; -1 &amp; \mid &amp; -3 &amp; 1 \end{pmatrix} \)</span></p>
<p>Calculation: Row 2 becomes <span class="math notranslate nohighlight">\(3 - 3 \cdot 1, 5 - 3 \cdot 2 \mid 0 - 3 \cdot 1, 1 - 3 \cdot 0 = 0, -1 \mid -3, 1\)</span></p>
<p>Scale row 2 to make the pivot 1:</p>
<p><span class="math notranslate nohighlight">\(R_2 \leftarrow -R_2\)</span></p>
<p><span class="math notranslate nohighlight">\( \begin{pmatrix} 1 &amp; 2 &amp; \mid &amp; 1 &amp; 0 \\ 0 &amp; -1 &amp; \mid &amp; -3 &amp; 1 \end{pmatrix} \rightarrow \begin{pmatrix} 1 &amp; 2 &amp; \mid &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; \mid &amp; 3 &amp; -1 \end{pmatrix} \)</span></p>
<p>Calculation: Row 2 becomes <span class="math notranslate nohighlight">\(0, -(-1) \mid -(-3), -1 = 0, 1 \mid 3, -1\)</span>$</p>
<p>Eliminate above the second pivot (1):</p>
<p><span class="math notranslate nohighlight">\( R_1 \leftarrow R_1 - 2R_2 \)</span></p>
<p><span class="math notranslate nohighlight">\(\begin{pmatrix} 1 &amp; 2 &amp; \mid &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; \mid &amp; 3 &amp; -1 \end{pmatrix} \rightarrow \begin{pmatrix} 1 &amp; 0 &amp; \mid &amp; -5 &amp; 2 \\ 0 &amp; 1 &amp; \mid &amp; 3 &amp; -1 \end{pmatrix} \)</span></p>
<p>Calculation: Row 1 becomes <span class="math notranslate nohighlight">\(1 - 2 \cdot 0, 2 - 2 \cdot 1 \mid 1 - 2 \cdot 3, 0 - 2 \cdot (-1) = 1, 0 \mid -5, 2\)</span></p>
<p>The left side is now the identity matrix, so the right side is the inverse:</p>
<p><span class="math notranslate nohighlight">\(A^{-1} = \begin{pmatrix} -5 &amp; 2 \\ 3 &amp; -1 \end{pmatrix}\)</span></p>
<p>Verification:</p>
<p>To confirm, compute <span class="math notranslate nohighlight">\(A A^{-1}\)</span>:</p>
<p><span class="math notranslate nohighlight">\(A A^{-1} = \begin{pmatrix} 1 &amp; 2 \\ 3 &amp; 5 \end{pmatrix} \begin{pmatrix} -5 &amp; 2 \\ 3 &amp; -1 \end{pmatrix} = \begin{pmatrix} 1 \cdot (-5) + 2 \cdot 3 &amp; 1 \cdot 2 + 2 \cdot (-1) \\ 3 \cdot (-5) + 5 \cdot 3 &amp; 3 \cdot 2 + 5 \cdot (-1) \end{pmatrix} = \begin{pmatrix} -5 + 6 &amp; 2 - 2 \\ -15 + 15 &amp; 6 - 5 \end{pmatrix} = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix}\)</span></p>
<p>This is the 2x2 identity matrix, confirming the inverse is correct.</p>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is singular, then elimination will fail (e.g., a zero row on the left).</p>
<p><strong>Python Script for Gauss-Jordan Sample Problems</strong></p>
<p>Below is a Python script that generates Markdown-formatted sample problems for finding matrix inverses using Gauss-Jordan elimination. It uses NumPy to generate random invertible 2x2 or 3x3 matrices, computes the inverse (for the solution), and outputs the problem (augmented matrix) and solution in Markdown. Run this script to generate a few examples, solve them by hand on paper, and check against the provided solutions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import numpy as np
import sys
from IPython.display import Markdown, display

def generate_sample_problems(num_problems=3, size=2):
    &quot;&quot;&quot;
    Generate Markdown sample problems and solutions for Gauss-Jordan matrix inverse.
    
    Args:
    - num_problems: Number of problems to generate (default: 3).
    - size: Matrix size (2 or 3; default: 2).
    
    Outputs Markdown to stdout.
    &quot;&quot;&quot;
    if size not in [2, 3]:
        raise ValueError(&quot;Size must be 2 or 3.&quot;)
    
    markdown = &quot;# Gauss-Jordan Sample Problems\n\n&quot;
    for i in range(1, num_problems + 1):
        # Generate random invertible integer matrix (entries -5 to 5, ensure det != 0)
        while True:
            A = np.random.randint(-5, 6, size=(size, size))
            if np.linalg.det(A) != 0:
                break
        
        # Compute inverse using NumPy (for solution)
        A_inv = np.linalg.inv(A)
        # Round to avoid floating-point issues, but since A is integer, inverse may not be
        # For simplicity, we&#39;ll display as fractions if needed, but here we use floats rounded
        A_inv_rounded = np.round(A_inv, decimals=2)
        
        # Augment A with I
        I = np.eye(size, dtype=int)
        augmented = np.hstack((A, I))
        
        # Format matrices as LaTeX for Markdown
        def matrix_to_latex(M):
            rows = [r&quot; &amp; &quot;.join(map(str, row)) for row in M]
            return r&quot;\begin{pmatrix} &quot; + r&quot; \\ &quot;.join(rows) + r&quot; \end{pmatrix}&quot;
        
        markdown += f&quot;## Problem {i}: Find the inverse of the following matrix using Gauss-Jordan elimination.\n\n&quot;
        markdown += f&quot;Matrix A:\n\n$$ {matrix_to_latex(A)} $$\n\n&quot;
        markdown += f&quot;Augmented matrix [A | I]:\n\n$$ {matrix_to_latex(augmented)} $$\n\n&quot;
        markdown += &quot;Perform row operations to reduce the left side to I.\n\n&quot;
        markdown += &quot;## Solution\n\n&quot;
        markdown += f&quot;Inverse A^{-1}:\n\n$$ {matrix_to_latex(A_inv_rounded)} $$\n\n&quot;
        markdown += &quot;---\n\n&quot;
    
    display(Markdown(markdown))

generate_sample_problems()
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="lecture-4-factorization-into-a-lu">
<h2>Lecture 4: Factorization into A = LU<a class="headerlink" href="#lecture-4-factorization-into-a-lu" title="Permalink to this heading">#</a></h2>
<iframe width="560" height="315"
    src="https://www.youtube.com/embed/MsIvs_6vC38"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen>
</iframe>
<p>This lecture introduces LU factorization, a method to decompose a matrix into simpler triangular forms, along with the inverse of matrix products and permutation matrices. These concepts streamline solving linear systems and enhance our understanding of matrix operations You’ll learn why LU factorization is efficient, how permutations handle row swaps, and get hands-on with an interactive tool to explore these ideas.</p>
<section id="inverse-of-matrix-products">
<h3>Inverse of Matrix Products<a class="headerlink" href="#inverse-of-matrix-products" title="Permalink to this heading">#</a></h3>
<p>For two invertible matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, the inverse of their product <span class="math notranslate nohighlight">\(AB\)</span> is:</p>
<p><span class="math notranslate nohighlight">\(
(AB)^{-1} = B^{-1} A^{-1}
\)</span></p>
<p>This holds because:</p>
<p><span class="math notranslate nohighlight">\(
(AB)(B^{-1} A^{-1}) = A (B B^{-1}) A^{-1} = A I A^{-1} = I
\)</span></p>
<p>The order of inverses reverses, which is crucial when rearranging matrix equations.
Additionally, if <span class="math notranslate nohighlight">\(A\)</span> is invertible, the inverse of its transpose is:</p>
<p><span class="math notranslate nohighlight">\(
(A^T)^{-1} = (A^{-1})^T
\)</span></p>
<p>These properties help us manipulate matrix equations, especially in LU factorization.</p>
</section>
<section id="lu-factorization-decomposing-matrices">
<h3>LU Factorization: Decomposing Matrices<a class="headerlink" href="#lu-factorization-decomposing-matrices" title="Permalink to this heading">#</a></h3>
<p>LU factorization breaks a square matrix <span class="math notranslate nohighlight">\(A\)</span> into:</p>
<p><span class="math notranslate nohighlight">\(L\)</span>: A lower triangular matrix with 1s on the diagonal and zeros above.</p>
<p><span class="math notranslate nohighlight">\(U\)</span>: An upper triangular matrix with zeros below the diagonal; our row-reduced matrix we found in the last lecture</p>
<p>We write:</p>
<p><span class="math notranslate nohighlight">\( 
A = LU 
\)</span></p>
<p>This is useful for solving systems <span class="math notranslate nohighlight">\(Ax = b\)</span>. Gaussian elimination transforms <span class="math notranslate nohighlight">\(A\)</span> into an upper triangular <span class="math notranslate nohighlight">\(U\)</span> using elimination matrices <span class="math notranslate nohighlight">\(E_{ij}\)</span>:</p>
<p><span class="math notranslate nohighlight">\( 
E_{32} E_{31} E_{21} A = U 
\)</span></p>
<p>Each <span class="math notranslate nohighlight">\(E_{ij}\)</span> eliminates an entry in row <span class="math notranslate nohighlight">\(i\)</span>, column <span class="math notranslate nohighlight">\(j\)</span> below the pivot by subtracting a multiple of row <span class="math notranslate nohighlight">\(j\)</span>. To express <span class="math notranslate nohighlight">\(A\)</span>, we rearrange:</p>
<p><span class="math notranslate nohighlight">\( 
A = (E_{32} E_{31} E_{21})^{-1} U 
\)</span></p>
<p>Using the inverse of products rule:</p>
<p><span class="math notranslate nohighlight">\(
(E_{32} E_{31} E_{21})^{-1} = E_{21}^{-1} E_{31}^{-1} E_{32}^{-1}
\)</span></p>
<p>This product of inverse elimination matrices forms <span class="math notranslate nohighlight">\(L\)</span>. If <span class="math notranslate nohighlight">\(E_{ij}\)</span> subtracts <span class="math notranslate nohighlight">\(c \cdot \text{row } j\)</span> from row <span class="math notranslate nohighlight">\(i\)</span> (i.e., <span class="math notranslate nohighlight">\(E_{ij} = I - c e_i e_j^T\)</span> ), its inverse <span class="math notranslate nohighlight">\(E_{ij}^{-1}\)</span> adds <span class="math notranslate nohighlight">\(c\)</span>, placing <span class="math notranslate nohighlight">\(c\)</span> in <span class="math notranslate nohighlight">\(L\)</span>’s <span class="math notranslate nohighlight">\((i,j)\)</span> position below the diagonal.</p>
<p>Why Use LU Factorization?</p>
<p><strong>Efficiency:</strong> Solving <span class="math notranslate nohighlight">\(Ax = b\)</span> via Gaussian elimination takes <span class="math notranslate nohighlight">\(\frac{1}{3}n^3\)</span> operations for an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix (each of <span class="math notranslate nohighlight">\(n\)</span> pivots requires <span class="math notranslate nohighlight">\(O(n^2)\)</span> work). With LU factorization:</p>
<p>Compute <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span> once <span class="math notranslate nohighlight">\(( \frac{1}{3}n^3 )\)</span>.</p>
<p>Solve <span class="math notranslate nohighlight">\(Ly = b\)</span> (forward substitution) and <span class="math notranslate nohighlight">\(Ux = y\)</span> (backward substitution), each in <span class="math notranslate nohighlight">\(\frac{1}{2}n^2\)</span></p>
<p>For <span class="math notranslate nohighlight">\(k\)</span> different <span class="math notranslate nohighlight">\(b\)</span> vectors, total cost is <span class="math notranslate nohighlight">\(\frac{1}{3}n^3 + k n^2 \)</span>, versus <span class="math notranslate nohighlight">\(k \cdot \frac{1}{3}n^3\)</span> without LU. This is a huge win for multiple solves.</p>
<p><strong>Simplicity:</strong> <span class="math notranslate nohighlight">\(L\)</span> collects the multipliers from elimination, making the process systematic. If no row swaps occur, <span class="math notranslate nohighlight">\(L\)</span>’s subdiagonal entries are exactly these multipliers.</p>
<p><strong>Flexibility:</strong> LU factorization works for any invertible matrix (with pivoting, if needed), simplifying computations like inverses or determinants.</p>
<p>Example: LU Factorization by Hand</p>
<p>Let’s factorize:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \begin{pmatrix} 2 &amp; 1 &amp; 1 \\ 4 &amp; -6 &amp; 0 \\ -2 &amp; 7 &amp; 2 \end{pmatrix} \end{split}\]</div>
<p>Step 1: Gaussian Elimination to Get <span class="math notranslate nohighlight">\(U\)</span></p>
<p>Column 1: Pivot is <span class="math notranslate nohighlight">\(A_{11} = 2\)</span></p>
<p>Eliminate <span class="math notranslate nohighlight">\(A_{21} = 4\)</span>: Multiplier <span class="math notranslate nohighlight">\(\frac{4}{2} = 2\)</span>. Operation: <span class="math notranslate nohighlight">\(R_2 \leftarrow R_2 - 2 R_1\)</span>.
<span class="math notranslate nohighlight">\(
[4, -6, 0] - 2 \cdot [2, 1, 1] = [4 - 4, -6 - 2, 0 - 2] = [0, -8, -2] 
\)</span></p>
<p>Eliminate <span class="math notranslate nohighlight">\(A_{31} = -2\)</span>: Multiplier <span class="math notranslate nohighlight">\(\frac{-2}{2} = -1 \)</span>. Operation: <span class="math notranslate nohighlight">\(R_3 \leftarrow R_3 + R_1\)</span>.
<span class="math notranslate nohighlight">\(
[-2, 7, 2] + [2, 1, 1] = [0, 7 + 1, 2 + 1] = [0, 8, 3]
\)</span>
New matrix:
<span class="math notranslate nohighlight">\(
\begin{pmatrix} 2 &amp; 1 &amp; 1 \\ 0 &amp; -8 &amp; -2 \\ 0 &amp; 8 &amp; 3 \end{pmatrix} 
\)</span></p>
<p>Column 2: Pivot is <span class="math notranslate nohighlight">\(A_{22} = -8\)</span>.</p>
<p>Eliminate <span class="math notranslate nohighlight">\(A_{32} = 8\)</span>: Multiplier <span class="math notranslate nohighlight">\(\frac{8}{-8} = -1\)</span>. Operation: <span class="math notranslate nohighlight">\(R_3 \leftarrow R_3 + R_2\)</span>.
<span class="math notranslate nohighlight">\(
[0, 8, 3] + [0, -8, -2] = [0, 8 - 8, 3 - 2] = [0, 0, 1] 
\)</span>
Result (upper triangular <span class="math notranslate nohighlight">\(U\)</span>):</p>
<p><span class="math notranslate nohighlight">\(
U = \begin{pmatrix} 2 &amp; 1 &amp; 1 \\ 0 &amp; -8 &amp; -2 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}
\)</span></p>
<p>Step 2: Construct <span class="math notranslate nohighlight">\(L\)</span></p>
<p>The multipliers form <span class="math notranslate nohighlight">\(L\)</span>:</p>
<p>Column 1: <span class="math notranslate nohighlight">\(L_{21} = 2\)</span>, <span class="math notranslate nohighlight">\(L_{31} = -1\)</span></p>
<p>Column 2: <span class="math notranslate nohighlight">\(L_{32} = -1\)</span></p>
<p>Diagonal: 1s.</p>
<p><span class="math notranslate nohighlight">\( 
L = \begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 2 &amp; 1 &amp; 0 \\ -1 &amp; -1 &amp; 1 \end{pmatrix}
\)</span></p>
<p>Step 3: Verify</p>
<p>Compute <span class="math notranslate nohighlight">\(LU\)</span>:</p>
<p><span class="math notranslate nohighlight">\(
LU = \begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 2 &amp; 1 &amp; 0 \\ -1 &amp; -1 &amp; 1 \end{pmatrix} \begin{pmatrix} 2 &amp; 1 &amp; 1 \\ 0 &amp; -8 &amp; -2 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}
\)</span></p>
<p>Row 1: <span class="math notranslate nohighlight">\([1 \cdot 2, 1 \cdot 1 + 0 \cdot (-8), 1 \cdot 1 + 0 \cdot (-2) + 0 \cdot 1] = [2, 1, 1]\)</span></p>
<p>Row 2: <span class="math notranslate nohighlight">\([2 \cdot 2, 2 \cdot 1 + 1 \cdot (-8), 2 \cdot 1 + 1 \cdot (-2) + 0 \cdot 1] = [4, 2 - 8, 2 - 2] = [4, -6, 0]\)</span></p>
<p>Row 3: <span class="math notranslate nohighlight">\([-1 \cdot 2, -1 \cdot 1 + (-1) \cdot (-8), -1 \cdot 1 + (-1) \cdot (-2) + 1 \cdot 1] = [-2, -1 + 8, -1 + 2 + 1] = [-2, 7, 2]\)</span></p>
<p><span class="math notranslate nohighlight">\( 
LU = \begin{pmatrix} 2 &amp; 1 &amp; 1 \\ 4 &amp; -6 &amp; 0 \\ -2 &amp; 7 &amp; 2 \end{pmatrix} = A 
\)</span></p>
<p><strong>Permutation Matrices:</strong></p>
<p>If a pivot is zero during elimination, we swap rows to find a non-zero pivot. This is done with a permutation matrix <span class="math notranslate nohighlight">\(P\)</span>, which reorders rows. For a 3x3 matrix, swapping rows 1 and 2:</p>
<p><span class="math notranslate nohighlight">\(
P = \begin{pmatrix} 0 &amp; 1 &amp; 0 \\ 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} 
\)</span></p>
<p>Applying <span class="math notranslate nohighlight">\(P\)</span> to <span class="math notranslate nohighlight">\(A\)</span> (i.e., <span class="math notranslate nohighlight">\(PA\)</span>) swaps rows 1 and 2. Permutation matrices have special properties:</p>
<p>Group Structure: The product of two permutation matrices is another permutation matrix, and every permutation has an inverse (another permutation in the group).</p>
<p>Inverse = Transpose: For any permutation matrix <span class="math notranslate nohighlight">\(P\)</span>, <span class="math notranslate nohighlight">\(P^T P = I\)</span>, so <span class="math notranslate nohighlight">\(P^{-1} = P^T\)</span>. For example:</p>
<p><span class="math notranslate nohighlight">\(
P = \begin{pmatrix} 0 &amp; 1 &amp; 0 \\ 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}, \quad P^T = \begin{pmatrix} 0 &amp; 1 &amp; 0 \\ 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} = P 
\)</span></p>
<p><span class="math notranslate nohighlight">\(
P P^T = \begin{pmatrix} 0 &amp; 1 &amp; 0 \\ 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} \begin{pmatrix} 0 &amp; 1 &amp; 0 \\ 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} = \begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} = I 
\)</span></p>
<p>In LU factorization, if row swaps are needed, we factorize:</p>
<p><span class="math notranslate nohighlight">\(
PA = LU 
\)</span></p>
<p>where <span class="math notranslate nohighlight">\(P\)</span> is the product of permutation matrices ensuring non-zero pivots.</p>
<p><strong>Interactive LU Factorization Demo</strong></p>
<p>Try the code below to factorize a matrix into <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span>, with or without pivoting. Modify the matrix or toggle pivoting to see how results change!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import numpy as np
from scipy.linalg import lu
from IPython.display import Markdown, display

def lu_factorization_demo(A=None, use_pivoting=True):
    &quot;&quot;&quot;
    Demonstrate LU factorization with optional pivoting.
    Displays A, P, L, U, and verifies PA = LU.
    &quot;&quot;&quot;
    
    P, L, U = lu(A)  # SciPy returns P, L, U where PA = LU

    
    # Format matrices as LaTeX
    def matrix_to_latex(M):
        rows = [r&quot; &amp; &quot;.join([f&quot;{x:.2f}&quot; if abs(x) &gt; 1e-10 else &quot;0&quot; for x in row]) for row in M]
        return r&quot;\begin{pmatrix} &quot; + r&quot; \\ &quot;.join(rows) + r&quot; \end{pmatrix}&quot;
    
    # Verify PA = LU
    PA = np.dot(P, A)
    LU = np.dot(L, U)
    verification = np.allclose(PA, LU)
    
    markdown = f&quot;## LU Factorization Demo\n\n&quot;
    markdown += f&quot;Matrix A:\n\n$$ {matrix_to_latex(A)} $$\n\n&quot;
    if use_pivoting:
        markdown += f&quot;Permutation Matrix P:\n\n$$ {matrix_to_latex(P)} $$\n\n&quot;
    markdown += f&quot;L (Lower triangular):\n\n$$ {matrix_to_latex(L)} $$\n\n&quot;
    markdown += f&quot;U (Upper triangular):\n\n$$ {matrix_to_latex(U)} $$\n\n&quot;
    markdown += f&quot;Verification (PA ≈ LU): {&#39;Correct&#39; if verification else &#39;Incorrect&#39;}\n\n&quot;
    markdown += &quot;Try editing the matrix A or toggling use_pivoting (True/False).\n\n&quot;
    
    display(Markdown(markdown))

# Example matrix
A = np.array([[2, 1, 1], [4, -6, 0], [-2, 7, 2]], dtype=float)
lu_factorization_demo(A, use_pivoting=False)

# Try a matrix requiring pivoting
A_pivot = np.array([[0, 1, 2], [1, 2, 3], [2, 5, 2]], dtype=float)
lu_factorization_demo(A_pivot, use_pivoting=True)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "jhs-39/COT6905_Optimization",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="syllabus.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Syllabus</p>
      </div>
    </a>
    <a class="right-next"
       href="week_two.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 2: Spaces</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-1-the-geometry-of-linear-equations">Lecture 1: The Geometry of Linear Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts">Key Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#row-picture">Row Picture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-picture">Column Picture</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-2-elimination-with-matrices">Lecture 2: Elimination with matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Key Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-elimination">Gaussian Elimination</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pivots">Pivots:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elimination-matrices">Elimination Matrices:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#permutation-matrices">Permutation Matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#composing-an-elimination-matrix">Composing an Elimination Matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#breakdowns">Breakdowns:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-3-multiplication-and-inverse-matrices">Lecture 3: Multiplication and inverse matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#five-ways-to-look-at-matrix-multiplication">Five Ways to Look at Matrix Multiplication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dot-product-of-rows-in-a-and-columns-in-b">Dot Product of Rows in A and Columns in B:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-way-linear-combinations-of-columns">Column Way (Linear Combinations of Columns):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#row-way-linear-combinations-of-rows">Row Way (Linear Combinations of Rows):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outer-product-way-sum-of-rank-1-matrices">Outer Product Way (Sum of Rank-1 Matrices):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-block-multiplication">Bonus: Block Multiplication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-inverses">Matrix Inverses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#singular-matrices-no-inverse">Singular Matrices (No Inverse)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-inverse-via-systems-of-equations">Finding the Inverse via Systems of Equations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-4-factorization-into-a-lu">Lecture 4: Factorization into A = LU</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-of-matrix-products">Inverse of Matrix Products</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lu-factorization-decomposing-matrices">LU Factorization: Decomposing Matrices</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jacob Sander
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>